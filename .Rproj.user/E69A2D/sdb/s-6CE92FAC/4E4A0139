{
    "collab_server" : "",
    "contents" : "#Install Packages\ninstall.packages(c(\"psych\", \"car\", \"ggplot2\", \"Hmisc\", \"corrplot\"))\n\n#Load Packages\nlibrary(psych)\nlibrary(car)\nlibrary(ggplot2)\nlibrary(Hmisc)\nlibrary(corrplot)\n\n#Load Data\nsetwd(\"~/GitHub/HEV\")\nattach(Integrated_Spreadsheet)\n\n#Histograms of HEVs per '000 cars across the UK \n\nhist(HEVp1000, breaks = 50, xlab = \"Hybrid Electric Vehicles per 'thousand'000 cars\", main = NULL, font.lab = 2, col = \"gray80\")\nhist(log(HEVln), breaks = 50, xlab = \"Hybrid Electric Vehicles per 'thousand'000 cars (ln)\", main = NULL, font.lab = 2, col = \"gray80\")\n\n#Descriptive Statistics\n\ndescribe(Integrated_Spreadsheet)\n\n#Bivariate Analaysis with Socioeconomics \n\npairs.panels(Integrated_Spreadsheet[c(5,45,53:66)], method = \"spearman\", hist.col = \"gray80\", ellipses = \"FALSE\", breaks = 25)\ncor1 <- rcorr(as.matrix(Integrated_Spreadsheet[c(5,45,53:66)]), type = \"spearman\")\ncor1\ncor1$r\ncor1$P\ncorrplot(cor1$r, type=\"upper\", order=\"original\", \n         p.mat = cor1$P, sig.level = 0.01, insig = \"blank\", tl.srt = 45, tl.col = \"black\")\n\n#Bivariate Analaysis with Travel \n\npairs.panels(Integrated_Spreadsheet[c(5,17:30, 34)], method = \"spearman\", hist.col = \"gray80\", ellipses = \"FALSE\", breaks = 25)\ncor2 <- rcorr(as.matrix(Integrated_Spreadsheet[c(5,17:30, 34)]), type = \"spearman\")\ncor2\ncor2$r\ncor2$P\ncorrplot(cor2$r, type=\"upper\", order=\"original\", \n         p.mat = cor2$P, sig.level = 0.01, insig = \"blank\", tl.srt = 45, tl.col = \"black\")\n\n#Bivariate Analaysis with Household\n\npairs.panels(Integrated_Spreadsheet[c(5, 35:44)], method = \"spearman\", hist.col = \"gray80\", ellipses = \"FALSE\", breaks = 25)\ncor3 <- rcorr(as.matrix(Integrated_Spreadsheet[c(5, 35:44)]), type = \"spearman\")\ncor3\ncor3$r\ncor3$P\ncorrplot(cor3$r, type=\"upper\", order=\"original\", \n         p.mat = cor3$P, sig.level = 0.01, insig = \"blank\", tl.srt = 45, tl.col = \"black\")\n\n#Scatterplot between HEVs per '000 cars and proximity to the London Congestion Charge\n\nggplot(Integrated_Spreadsheet[which(Integrated_Spreadsheet$DistLCCln>0),], aes(x=DistLCCln, y=HEVln)) +\n  geom_point(shape=1) + \n  xlab(\"Euclidean Distance to the London Congest Charge (ln)\") +\n  ylab(\"Hybrid Electric Vehicles per '000 cars (ln)\") +\n  theme(axis.title.y=element_text(color = \"black\", face=\"bold\")) +\n  theme(axis.title.x=element_text(color = \"black\", face=\"bold\")) +\n  theme(axis.text.x=element_text(color = \"black\", size=12)) +\n  theme(axis.text.y=element_text(color = \"black\", size=12)) +\n  geom_smooth(method=lm,\n              se=FALSE)\n\n#Scatterplot between HEVs per '000 cars and interaction with the London Congestion Charge\n\nggplot(Integrated_Spreadsheet, aes(x=PropDriveLCC1kln, y=HEVln)) +\n    geom_point(shape=1) + \n    xlab(\"Number of residents per '000 driving a car to work in the City of London (ln)\") +\n    ylab(\"Hybrid Electric Vehicles per '000 cars (ln)\") +\n    theme(axis.title.y=element_text(color = \"black\", face=\"bold\")) +\n    theme(axis.title.x=element_text(color = \"black\", face=\"bold\")) +\n    theme(axis.text.x=element_text(color = \"black\", size=12)) +\n    theme(axis.text.y=element_text(color = \"black\", size=12)) +\n  geom_smooth(method=lm,\n              se=FALSE)\n\n#Boxplots of Area Categories against Hybrid Electric Vehicles per '000 cars and Kruskal Wallis Test\n\n  Integrated_Spreadsheet$AreaCat <- factor(Integrated_Spreadsheet$AreaCat)\n\n  ggplot(Integrated_Spreadsheet, aes(x=AreaCat, y=HEVp1000)) + geom_boxplot() theme(axis.text.x=element_text(angle=30, vjust=0.8, hjust=1, face=\"bold\"))\n  ggbox <- ggplot(Integrated_Spreadsheet, aes(x=AreaCat, y=HEVp1000)) + geom_boxplot(outlier.shape = NA)\n  ggbox <- ggbox + theme(axis.text.x=element_text(color = \"black\", size=12)) \n  ggbox <- ggbox + theme(axis.text.y=element_text(color = \"black\", size=12))\n  ggbox <- ggbox + theme(axis.title.x=element_text(color = \"black\", face=\"bold\"))\n  ggbox <- ggbox + theme(axis.title.y=element_text(color = \"black\", face=\"bold\"))\n  ggbox <- ggbox + ylab(\"Hybrid Electric Vehicles per '000 cars\") + xlab(\"Local Authority Categories\")\n  ggbox <- ggbox + coord_cartesian(ylim = c(0, 20))\n  ggbox\n  \n  kruskal.test(HEVp1000 ~ AreaCat, data = Integrated_Spreadsheet)\n  \n# Benchmark OLS log-log Regression Models\n\nmod1 <- lm(HEVln ~ MeanAgeln + Level4ln + MeanY1kln + OneCarln + DriveWorkln + PopDln + MeanHSizeln + CCars1kln)\nsummary(mod1)\npar(mfrow=c(2,2))\nplot(mod1, main = \"Demographic Model\")\nvif(mod1)\nanova(mod1)\n\nmod2 <- lm(HEVln ~ MeanAgeln + Level4ln + MeanY1kln + OneCarln + DriveWorkln + PopDln + MeanHSizeln + CCars1kln + LondonB + FirstNei + SecNei)\nsummary(mod2)\npar(mfrow=c(2,2))\nplot(mod2, main = \"Contiguity Model\")\nvif(mod2)\nanova(mod2)\n\nmod3 <- lm(HEVln ~ MeanAgeln + Level4ln + MeanY1kln + OneCarln + DriveWorkln + PopDln + MeanHSizeln + CCars1kln + DistLCCln)\nsummary(mod3)\npar(mfrow=c(2,2))\nplot(mod3, main = \"Proximity Model\")\nvif(mod3)\nanova(mod3)\n\nmod4 <- lm(HEVln ~ MeanAgeln + Level4ln + MeanY1kln + OneCarln + DriveWorkln + PopDln + MeanHSizeln + CCars1kln + PropDriveLCC1kln)\nsummary(mod4)\npar(mfrow=c(2,2))\nplot(mod4, main = \"Interaction Model\")\nvif(mod4)\nanova(mod4)",
    "created" : 1507274636856.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1964617757",
    "id" : "4E4A0139",
    "lastKnownWriteTime" : 1510155171,
    "last_content_update" : 1510155171727,
    "path" : "~/GitHub/HEV/Code/Descriptive Stats and Regression Models.R",
    "project_path" : "Code/Descriptive Stats and Regression Models.R",
    "properties" : {
        "source_window_id" : ""
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}